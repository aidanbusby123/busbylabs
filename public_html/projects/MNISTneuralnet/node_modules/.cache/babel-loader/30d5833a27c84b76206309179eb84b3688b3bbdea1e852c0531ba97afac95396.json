{"ast":null,"code":"import React,{useRef,useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const canvasRef=useRef(null);const[prediction,setPrediction]=useState(null);const[blockSize,setBlockSize]=useState(10);// Size of each block\n// Function to calculate and set block size based on screen dimensions\nuseEffect(()=>{const calculateBlockSize=()=>{const width=window.innerWidth;const height=window.innerHeight;const size=Math.min(width,height)/28;// 1/28th of the smaller dimension\nsetBlockSize(size);};calculateBlockSize();window.addEventListener('resize',calculateBlockSize);// Recalculate on window resize\nreturn()=>{window.removeEventListener('resize',calculateBlockSize);};},[]);// Function to clear the canvas\nconst clearCanvas=()=>{const canvas=canvasRef.current;const ctx=canvas.getContext('2d');ctx.clearRect(0,0,canvas.width,canvas.height);};// Function to send the canvas data to the backend\nconst predictDigit=async()=>{const canvas=canvasRef.current;const ctx=canvas.getContext('2d');// Get the image data from the canvas\nconst imageData=ctx.getImageData(0,0,canvas.width,canvas.height);const grayscaleData=[];for(let i=0;i<imageData.data.length;i+=4){// Convert to grayscale (average of R, G, B)\nconst grayscale=(imageData.data[i]+imageData.data[i+1]+imageData.data[i+2])/3;grayscaleData.push(grayscale);}// Resize the image to 28x28 (MNIST format)\nconst resizedData=[];const scale=canvas.width/28;for(let y=0;y<28;y++){for(let x=0;x<28;x++){const pixelIndex=Math.floor(y*scale)*canvas.width+Math.floor(x*scale);resizedData.push(grayscaleData[pixelIndex]);}}try{// Send the image data to the backend\nconst response=await axios.post('http://localhost:5000/predict',{image:resizedData});setPrediction(response.data.digit);}catch(error){console.error('Error predicting digit:',error);}};// Function to draw blocks on the canvas\nconst drawBlock=e=>{const canvas=canvasRef.current;const ctx=canvas.getContext('2d');const rect=canvas.getBoundingClientRect();// Get the mouse position relative to the canvas\nconst x=e.clientX-rect.left;const y=e.clientY-rect.top;// Calculate the top-left corner of the block\nconst x1=Math.floor(x/blockSize)*blockSize;const y1=Math.floor(y/blockSize)*blockSize;// Draw a filled rectangle (block)\nctx.fillStyle='black';ctx.fillRect(x1,y1,blockSize,blockSize);};return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Draw a Digit\"}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,width:280,height:280,style:{border:'1px solid black'},onMouseMove:e=>{if(e.buttons!==1)return;// Only draw when the left mouse button is pressed\ndrawBlock(e);},onMouseDown:e=>drawBlock(e)// Draw on mouse down\n}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:predictDigit,children:\"Predict\"}),/*#__PURE__*/_jsx(\"button\",{onClick:clearCanvas,children:\"Clear\"})]}),prediction!==null&&/*#__PURE__*/_jsxs(\"h2\",{children:[\"Predicted Digit: \",prediction]})]});}export default App;","map":{"version":3,"names":["React","useRef","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","App","canvasRef","prediction","setPrediction","blockSize","setBlockSize","calculateBlockSize","width","window","innerWidth","height","innerHeight","size","Math","min","addEventListener","removeEventListener","clearCanvas","canvas","current","ctx","getContext","clearRect","predictDigit","imageData","getImageData","grayscaleData","i","data","length","grayscale","push","resizedData","scale","y","x","pixelIndex","floor","response","post","image","digit","error","console","drawBlock","e","rect","getBoundingClientRect","clientX","left","clientY","top","x1","y1","fillStyle","fillRect","style","textAlign","children","ref","border","onMouseMove","buttons","onMouseDown","onClick"],"sources":["/home/aidan/busbylabs/public_html/projects/MNISTneuralnet/src/App.js"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport axios from 'axios';\n\nfunction App() {\n  const canvasRef = useRef(null);\n  const [prediction, setPrediction] = useState(null);\n  const [blockSize, setBlockSize] = useState(10); // Size of each block\n\n  // Function to calculate and set block size based on screen dimensions\n  useEffect(() => {\n    const calculateBlockSize = () => {\n      const width = window.innerWidth;\n      const height = window.innerHeight;\n      const size = Math.min(width, height) / 28; // 1/28th of the smaller dimension\n      setBlockSize(size);\n    };\n\n    calculateBlockSize();\n    window.addEventListener('resize', calculateBlockSize); // Recalculate on window resize\n\n    return () => {\n      window.removeEventListener('resize', calculateBlockSize);\n    };\n  }, []);\n\n  // Function to clear the canvas\n  const clearCanvas = () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n  };\n\n  // Function to send the canvas data to the backend\n  const predictDigit = async () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n\n    // Get the image data from the canvas\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    const grayscaleData = [];\n    for (let i = 0; i < imageData.data.length; i += 4) {\n      // Convert to grayscale (average of R, G, B)\n      const grayscale = (imageData.data[i] + imageData.data[i + 1] + imageData.data[i + 2]) / 3;\n      grayscaleData.push(grayscale);\n    }\n\n    // Resize the image to 28x28 (MNIST format)\n    const resizedData = [];\n    const scale = canvas.width / 28;\n    for (let y = 0; y < 28; y++) {\n      for (let x = 0; x < 28; x++) {\n        const pixelIndex = Math.floor(y * scale) * canvas.width + Math.floor(x * scale);\n        resizedData.push(grayscaleData[pixelIndex]);\n      }\n    }\n\n    try {\n      // Send the image data to the backend\n      const response = await axios.post('http://localhost:5000/predict', {\n        image: resizedData,\n      });\n      setPrediction(response.data.digit);\n    } catch (error) {\n      console.error('Error predicting digit:', error);\n    }\n  };\n\n  // Function to draw blocks on the canvas\n  const drawBlock = (e) => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const rect = canvas.getBoundingClientRect();\n\n    // Get the mouse position relative to the canvas\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n\n    // Calculate the top-left corner of the block\n    const x1 = Math.floor(x / blockSize) * blockSize;\n    const y1 = Math.floor(y / blockSize) * blockSize;\n\n    // Draw a filled rectangle (block)\n    ctx.fillStyle = 'black';\n    ctx.fillRect(x1, y1, blockSize, blockSize);\n  };\n\n  return (\n    <div style={{ textAlign: 'center' }}>\n      <h1>Draw a Digit</h1>\n      <canvas\n        ref={canvasRef}\n        width={280}\n        height={280}\n        style={{ border: '1px solid black' }}\n        onMouseMove={(e) => {\n          if (e.buttons !== 1) return; // Only draw when the left mouse button is pressed\n          drawBlock(e);\n        }}\n        onMouseDown={(e) => drawBlock(e)} // Draw on mouse down\n      />\n      <div>\n        <button onClick={predictDigit}>Predict</button>\n        <button onClick={clearCanvas}>Clear</button>\n      </div>\n      {prediction !== null && <h2>Predicted Digit: {prediction}</h2>}\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}